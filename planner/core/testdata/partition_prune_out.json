[
  {
    "Name": "TestListColumnsPartitionPrune",
    "Cases": [
      {
        "SQL": "select * from t1 where a = 1 or b = 2",
        "Result": [
          "1 1 1",
          "2 2 2"
        ],
        "Plan": [
          "TableReader_7 19.99 root partition:p0 data:Selection_6",
          "└─Selection_6 19.99 cop[tikv]  or(eq(test_partition.t1.a, 1), eq(test_partition.t1.b, 2))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 and b = 2",
        "Result": null,
        "Plan": [
          "TableReader_7 0.01 root partition:dual data:Selection_6",
          "└─Selection_6 0.01 cop[tikv]  eq(test_partition.t1.a, 1), eq(test_partition.t1.b, 2)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 and b = 1",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 0.01 root partition:p0 data:Selection_6",
          "└─Selection_6 0.01 cop[tikv]  eq(test_partition.t1.a, 1), eq(test_partition.t1.b, 1)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a in (1,2,3) or b in (4,5,6)",
        "Result": [
          "1 1 1",
          "2 2 2",
          "3 3 3",
          "4 4 4",
          "5 5 5",
          "6 6 6"
        ],
        "Plan": [
          "TableReader_7 59.91 root partition:p0,p1 data:Selection_6",
          "└─Selection_6 59.91 cop[tikv]  or(in(test_partition.t1.a, 1, 2, 3), in(test_partition.t1.b, 4, 5, 6))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a in (1,2,3) and b in (4,5,6)",
        "Result": null,
        "Plan": [
          "TableReader_7 0.09 root partition:dual data:Selection_6",
          "└─Selection_6 0.09 cop[tikv]  in(test_partition.t1.a, 1, 2, 3), in(test_partition.t1.b, 4, 5, 6)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a in (1,2,3) and b in (3,4,6)",
        "Result": [
          "3 3 3"
        ],
        "Plan": [
          "TableReader_7 0.09 root partition:p0 data:Selection_6",
          "└─Selection_6 0.09 cop[tikv]  in(test_partition.t1.a, 1, 2, 3), in(test_partition.t1.b, 3, 4, 6)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a in (1,2,3) and b in (1,2,3)",
        "Result": [
          "1 1 1",
          "2 2 2",
          "3 3 3"
        ],
        "Plan": [
          "TableReader_7 0.09 root partition:p0 data:Selection_6",
          "└─Selection_6 0.09 cop[tikv]  in(test_partition.t1.a, 1, 2, 3), in(test_partition.t1.b, 1, 2, 3)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where ( a=1 and b=1) or (a=6 and b=6)",
        "Result": [
          "1 1 1",
          "6 6 6"
        ],
        "Plan": [
          "TableReader_7 0.02 root partition:p0,p1 data:Selection_6",
          "└─Selection_6 0.02 cop[tikv]  or(and(eq(test_partition.t1.a, 1), eq(test_partition.t1.b, 1)), and(eq(test_partition.t1.a, 6), eq(test_partition.t1.b, 6)))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 100 and b = 100",
        "Result": null,
        "Plan": [
          "TableReader_7 0.01 root partition:dual data:Selection_6",
          "└─Selection_6 0.01 cop[tikv]  eq(test_partition.t1.a, 100), eq(test_partition.t1.b, 100)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 join t2 on t1.id = t2.id where (t1.a=1 or t1.a = 3 and t1.b in (3,5)) and t2.a in (6,7,8) and t2.b=7 and t2.id=7",
        "Result": null,
        "Plan": [
          "Projection_7 0.00 root  test_partition.t1.id, test_partition.t1.a, test_partition.t1.b, test_partition.t2.id, test_partition.t2.a, test_partition.t2.b",
          "└─HashJoin_9 0.00 root  CARTESIAN inner join",
          "  ├─TableReader_12(Build) 0.00 root partition:p1 data:Selection_11",
          "  │ └─Selection_11 0.00 cop[tikv]  eq(test_partition.t2.b, 7), eq(test_partition.t2.id, 7), in(test_partition.t2.a, 6, 7, 8)",
          "  │   └─TableFullScan_10 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "  └─TableReader_15(Probe) 0.01 root partition:all data:Selection_14",
          "    └─Selection_14 0.01 cop[tikv]  eq(test_partition.t1.id, 7), or(eq(test_partition.t1.a, 1), and(eq(test_partition.t1.a, 3), in(test_partition.t1.b, 3, 5)))",
          "      └─TableFullScan_13 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 left join t2 on true where (t1.a=1 or t1.a = 3 and t1.b in (3,5)) and t2.a in (6,7,8) and t2.b=7 and t2.id = 7",
        "Result": [
          "1 1 1 7 7 7",
          "3 3 3 7 7 7"
        ],
        "Plan": [
          "HashJoin_7 80.16 root  CARTESIAN inner join",
          "├─TableReader_14(Build) 8.00 root partition:p1 data:Selection_13",
          "│ └─Selection_13 8.00 cop[tikv]  1, eq(test_partition.t2.b, 7), eq(test_partition.t2.id, 7), in(test_partition.t2.a, 6, 7, 8)",
          "│   └─TableFullScan_12 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "└─TableReader_11(Probe) 10.02 root partition:all data:Selection_10",
          "  └─Selection_10 10.02 cop[tikv]  1, or(eq(test_partition.t1.a, 1), and(eq(test_partition.t1.a, 3), in(test_partition.t1.b, 3, 5)))",
          "    └─TableFullScan_9 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 10.00 root partition:p0 data:Selection_6",
          "└─Selection_6 10.00 cop[tikv]  eq(test_partition.t1.a, 1)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where b = 1",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 10.00 root partition:p0 data:Selection_6",
          "└─Selection_6 10.00 cop[tikv]  eq(test_partition.t1.b, 1)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 or b = 2",
        "Result": [
          "1 1 1",
          "2 2 2"
        ],
        "Plan": [
          "TableReader_7 19.99 root partition:p0 data:Selection_6",
          "└─Selection_6 19.99 cop[tikv]  or(eq(test_partition.t1.a, 1), eq(test_partition.t1.b, 2))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 or (a = 2 and b = 2) or ((a,b) in ((4,4),(5,5)))",
        "Result": [
          "1 1 1",
          "2 2 2",
          "4 4 4",
          "5 5 5"
        ],
        "Plan": [
          "TableReader_7 10.03 root partition:p0 data:Selection_6",
          "└─Selection_6 10.03 cop[tikv]  or(or(eq(test_partition.t1.a, 1), and(eq(test_partition.t1.a, 2), eq(test_partition.t1.b, 2))), or(and(eq(test_partition.t1.a, 4), eq(test_partition.t1.b, 4)), and(eq(test_partition.t1.a, 5), eq(test_partition.t1.b, 5))))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 or (a is null and b = 10)",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 10.01 root partition:p0 data:Selection_6",
          "└─Selection_6 10.01 cop[tikv]  or(eq(test_partition.t1.a, 1), and(isnull(test_partition.t1.a), eq(test_partition.t1.b, 10)))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 or (a = 10 and b is null)",
        "Result": [
          "1 1 1",
          "<nil> 10 <nil>"
        ],
        "Plan": [
          "TableReader_7 10.01 root partition:p0,p1 data:Selection_6",
          "└─Selection_6 10.01 cop[tikv]  or(eq(test_partition.t1.a, 1), and(eq(test_partition.t1.a, 10), isnull(test_partition.t1.b)))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 8 or (a = 10 and b is null)",
        "Result": [
          "8 8 8",
          "<nil> 10 <nil>"
        ],
        "Plan": [
          "TableReader_7 10.01 root partition:p1 data:Selection_6",
          "└─Selection_6 10.01 cop[tikv]  or(eq(test_partition.t1.a, 8), and(eq(test_partition.t1.a, 10), isnull(test_partition.t1.b)))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 and false",
        "Result": null,
        "Plan": [
          "TableDual_6 0.00 root  rows:0"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 and true",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 10.00 root partition:p0 data:Selection_6",
          "└─Selection_6 10.00 cop[tikv]  eq(test_partition.t1.a, 1)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 or false",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 10.00 root partition:all data:Selection_6",
          "└─Selection_6 10.00 cop[tikv]  or(eq(test_partition.t1.a, 1), 0)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 or true",
        "Result": [
          "1 1 1",
          "2 2 2",
          "3 3 3",
          "4 4 4",
          "5 5 5",
          "6 6 6",
          "7 7 7",
          "8 8 8",
          "9 9 9",
          "10 10 10",
          "<nil> 10 <nil>"
        ],
        "Plan": [
          "TableReader_7 10000.00 root partition:all data:Selection_6",
          "└─Selection_6 10000.00 cop[tikv]  or(eq(test_partition.t1.a, 1), 1)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 100 or b in (100,200)",
        "Result": null,
        "Plan": [
          "TableReader_7 29.98 root partition:dual data:Selection_6",
          "└─Selection_6 29.98 cop[tikv]  or(eq(test_partition.t1.a, 100), in(test_partition.t1.b, 100, 200))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a in (1,6) or b in (1,2) or (a=3 and b =3)",
        "Result": [
          "1 1 1",
          "2 2 2",
          "3 3 3",
          "6 6 6"
        ],
        "Plan": [
          "TableReader_7 39.97 root partition:p0,p1 data:Selection_6",
          "└─Selection_6 39.97 cop[tikv]  or(or(in(test_partition.t1.a, 1, 6), in(test_partition.t1.b, 1, 2)), and(eq(test_partition.t1.a, 3), eq(test_partition.t1.b, 3)))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a in (1,6)",
        "Result": [
          "1 1 1",
          "6 6 6"
        ],
        "Plan": [
          "TableReader_7 20.00 root partition:p0,p1 data:Selection_6",
          "└─Selection_6 20.00 cop[tikv]  in(test_partition.t1.a, 1, 6)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a in (1,6) and (a=3 and b =3)",
        "Result": null,
        "Plan": [
          "TableReader_7 0.00 root partition:dual data:Selection_6",
          "└─Selection_6 0.00 cop[tikv]  eq(test_partition.t1.a, 3), eq(test_partition.t1.b, 3), in(test_partition.t1.a, 1, 6)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 and (b=6 or a=6)",
        "Result": null,
        "Plan": [
          "TableReader_7 0.02 root partition:dual data:Selection_6",
          "└─Selection_6 0.02 cop[tikv]  eq(test_partition.t1.a, 1), or(eq(test_partition.t1.b, 6), eq(test_partition.t1.a, 6))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 100 and (b=100 or a=100)",
        "Result": null,
        "Plan": [
          "TableReader_7 0.02 root partition:dual data:Selection_6",
          "└─Selection_6 0.02 cop[tikv]  eq(test_partition.t1.a, 100), or(eq(test_partition.t1.b, 100), eq(test_partition.t1.a, 100))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where a = 1 or (a+b=3)",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 8002.00 root partition:all data:Selection_6",
          "└─Selection_6 8002.00 cop[tikv]  or(eq(test_partition.t1.a, 1), eq(plus(test_partition.t1.a, test_partition.t1.b), 3))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where id = 1 or id=2",
        "Result": [
          "1 1 1",
          "2 2 2"
        ],
        "Plan": [
          "TableReader_7 20.00 root partition:all data:Selection_6",
          "└─Selection_6 20.00 cop[tikv]  or(eq(test_partition.t1.id, 1), eq(test_partition.t1.id, 2))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 where id = 1 and a=1",
        "Result": [
          "1 1 1"
        ],
        "Plan": [
          "TableReader_7 0.01 root partition:all data:Selection_6",
          "└─Selection_6 0.01 cop[tikv]  eq(test_partition.t1.a, 1), eq(test_partition.t1.id, 1)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "select * from t1 partition(p1) where a = 1 or b = 2",
        "Result": null,
        "Plan": [
          "TableReader_7 19.99 root partition:dual data:Selection_6",
          "└─Selection_6 19.99 cop[tikv]  or(eq(test_partition.t1.a, 1), eq(test_partition.t1.b, 2))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ]
      }
    ]
  }
]
