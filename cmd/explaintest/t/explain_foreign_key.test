set @@global.tidb_enable_foreign_key=1;
set @@foreign_key_checks=1;
use test;
drop table if exists t1,t2;
create table t1 (id int key);
create table t2 (id int key, foreign key fk(id) references t1(id) ON UPDATE CASCADE ON DELETE CASCADE);
create table t3 (id int, unique index idx(id));
create table t4 (id int, index idx_id(id),foreign key fk(id) references t3(id));
create table t5 (id int key, id2 int, id3 int, unique index idx2(id2), index idx3(id3));
create table t6 (id int,     id2 int, id3 int, index idx_id(id), index idx_id2(id2), foreign key fk_1 (id) references t5(id) ON UPDATE CASCADE ON DELETE CASCADE, foreign key fk_2 (id2) references t5(id2) ON UPDATE CASCADE, foreign key fk_3 (id3) references t5(id3) ON DELETE CASCADE);

explain insert into t2 values (1);
explain update t2 set id=id+1 where id = 1;
explain delete from t1 where id > 1;
explain update t1 set id=id+1 where id = 1;
explain insert into t1 values (1);
explain insert into t1 values (1) on duplicate key update id = 100;
explain insert into t4 values (1);
explain update t4 set id=id+1 where id = 1;
explain delete from t3 where id > 1;
explain update t3 set id=id+1 where id = 1;
explain insert into t3 values (1);
explain insert into t3 values (1) on duplicate key update id = 100;
explain insert into t6 values (1,1,1);
explain update t6 set id=id+1, id3=id2+1 where id = 1;
explain delete from t5 where id > 1;
explain update t5 set id=id+1, id2=id2+1 where id = 1;
explain update t5 set id=id+1, id2=id2+1, id3=id3+1 where id = 1;
explain insert into t5 values (1,1,1);
explain insert into t5 values (1,1,1) on duplicate key update id = 100, id3=100;
explain insert into t5 values (1,1,1) on duplicate key update id = 100, id2=100, id3=100;
